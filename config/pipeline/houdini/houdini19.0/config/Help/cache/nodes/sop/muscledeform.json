{"type": "root", "attrs": {"type": "node", "context": "sop", "internal": "muscledeform", "icon": "SOP/muscledeform", "tags": "muscle, deform, displace, reshape, model, rigging", "since": "16.0", "status": "deprecated", "index": "no", "version": null, "namespace": null}, "body": [{"level": 0, "type": "title", "indent": 0, "text": ["Muscle Deform"], "extent": [0, 18]}, {"type": "warning_group", "body": [{"ext": null, "type": "warning", "indent": 0, "text": ["Deprecated"], "role": "item", "extent": [195, 216], "body": [{"type": "para", "indent": 4, "text": ["The object-level Muscle tools are now deprecated pending the release of the new SOP-based ", {"scheme": null, "value": "/news/19/muscles", "type": "link", "text": ["Muscles & Tissue"], "fullpath": "/news/19/muscles"}, " system."], "extent": [216, 356]}], "container": true}], "container": true, "role": "item_group"}, {"type": "summary", "indent": 0, "text": ["Deforms a surface mesh representing skin to envelop or drape over geometry representing muscles"], "extent": [356, 459]}, {"type": "para", "indent": 0, "text": ["In a character workflow with muscles and skin, this tool allows you to push skin\ngeometry outward until it encapsulates all the given muscles. "], "extent": [459, 604]}, {"type": "para", "indent": 0, "text": ["Although this tool is designed for skin and muscles, it may be used in other\ncontexts where a quick draping effect or a somewhat more sophisticated ray cast\nis desired."], "extent": [604, 775]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Using Muscle Deform"], "extent": [775, 801], "body": [{"type": "para", "indent": 0, "text": ["Select the skin geometry you would like to deform or displace.  This will be set\nin the ", {"type": "ui", "text": ["Group"]}, " parameter. Select the muscles you would like to affect the\ndeformation in the ", {"type": "ui", "text": ["Muscle Group"]}, " parameter.\nThe given skin geometry will be projected away from any points provided in the\ninput muscle geometry belonging to the ", {"type": "ui", "text": ["Muscle Center Group"]}, " until they hit\nthe surface of the muscle. This projection can be controlled with a number of\nparameters given below."], "extent": [801, 1266]}, {"type": "para", "indent": 0, "text": ["Sometimes you may want to project the skin geometry to the muscles using the\nnormal direction on the skin geometry (these normals will be computed\ninside ", {"type": "ui", "text": ["Muscle Deform"]}, " so no need to pre-compute them ahead of time). To\nachieve this, simply turn off the ", {"type": "ui", "text": ["Project from Muscle Centers"]}, " toggle, or\nalternatively slide the ", {"type": "ui", "text": ["Normal Projection Mixing"]}, " to 1 if you still prefer to\nuse the ", {"type": "ui", "text": ["Center Projection Control"]}, " options."], "extent": [1266, 1694]}, {"type": "para", "indent": 0, "text": ["Performance may be improved at the cost of quality and limited control.  Turning\noff the ", {"type": "ui", "text": ["Project from Muscle Centers"]}, " toggle will improve performance\nsignificantly, although it may not produce desirable results for non-convex skin\ngeometries.  Setting ", {"type": "ui", "text": ["Blend Radius"]}, " to zero will achieve a similar performance\nincrease however the quality of the projection will heavily rely on the\nplacement and frequency of muscle centers throughout the animation. If some\ncenter points fall outside of the skin geometry, disturbing artifacts will\ndominate the resulting mesh.  Increasing ", {"type": "ui", "text": ["Blend Radius"]}, " will help\neliminate these artifacts by considering neighboring point centers when\ncomputing the position to project the skin from.  Furthermore, the ", {"type": "ui", "text": ["Min Surf\nDistance"]}, " parameter will project muscle centers back into the skin geometry if\nthey happen to come within the specified distance or if they protrude through\nthe skin. However these tools are often non sufficient for providing truly\nartifact free result, so care must always be taken when placing muscle center\npoints, ensuring they fall well inside the simulated skin."], "extent": [1694, 2821]}, {"type": "para", "indent": 0, "text": ["In cases where the skin geometry is concave, as is the case with most character\nmodels, extra care must be taken when using this tool.  More specifically, the\nprojection rays used to place the skin geometry over the given muscles may hit a\nmuscle belonging to a different part of the character resulting in disturbing\nartifacts. To avoid these issues you must group different muscle groups under a\nunique ID attribute and specify this attribute in the ", {"type": "ui", "text": ["Muscle ID Attribute"]}, "\nparameter. Note that this attribute must exist on muscle primitives as well as\nmuscle centers. This allows ", {"type": "ui", "text": ["Muscle Deform"]}, " to consider each muscle group\nindividually, and combine the results of each projection at a later stage.  To\ncontrol displacement where different muscle groups overlap, use the ", {"type": "ui", "text": ["Overlap\nExponent"]}, " parameter."], "extent": [2821, 3632]}, {"type": "para", "indent": 0, "text": ["This SOP may also be used with the ", {"scheme": "Node", "value": "/nodes/sop/musclecapture", "type": "link", "text": ["Muscle Capture SOP"], "fullpath": "/nodes/sop/musclecapture"}, ",\nwhich assigns weights to individual muscle groups (specified by the unique\n", {"type": "ui", "text": ["Muscle ID Attribute"]}, " you provide).  Muscle capture weights can be used to\ncontrol where the displacement should occur. If ", {"type": "ui", "text": ["Attenuate with Weights"]}, " is\nturned on, the capture weights will act as a multiplier for the resulting\ndisplacement.  For more details see the documentation for ", {"scheme": "Node", "value": "/nodes/sop/musclecapture", "type": "link", "text": ["Muscle\nCapture"], "fullpath": "/nodes/sop/musclecapture"}, "."], "extent": [3632, 4118]}]}, {"level": 1, "id": "parameters", "container": true, "type": "parameters_section", "indent": 0, "role": "section", "extent": [4118, 4130], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Group"], "extent": [4130, 4138], "body": [{"type": "para", "indent": 4, "text": ["Subset of points to be deformed."], "extent": [4138, 4176]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Muscle Group"], "extent": [4176, 4190], "body": [{"type": "para", "indent": 4, "text": ["Subset of muscles to be considered for deformation."], "extent": [4190, 4247]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Muscle Center Group"], "extent": [4247, 4268], "body": [{"type": "para", "indent": 4, "text": ["Subset of points at the second (or third if specified) input to be considered as projection sources. Points on the skin will be the projected away from these center points if the ", {"type": "ui", "text": ["Project from Muscle Centers"]}, " option is on."], "extent": [4268, 4498]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Muscle ID Attribute"], "extent": [4498, 4519], "body": [{"type": "para", "indent": 4, "text": ["Name of the attribute specifying unique groups of muscles. Skin points being projected from centers of one muscle group will only be projected to the muscle primitives in the same group. This avoids different muscle groups affecting each other in non-convex areas of the model."], "extent": [4519, 4802]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Falloff Attribute"], "extent": [4802, 4821], "body": [{"type": "para", "indent": 4, "text": ["Weight attribute which acts as a global multiplier for displacements produced by this tool."], "extent": [4821, 4918]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Pin Border Points"], "extent": [4918, 4937], "body": [{"type": "para", "indent": 4, "text": ["Fix the positions of points adjacent to unshared edges on the input skin geometry."], "extent": [4937, 5025]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Bulge to Max Weight"], "extent": [5025, 5046], "body": [{"type": "para", "indent": 4, "text": ["Use the input capture weights to determine which muscle to project to in areas of overlap between different muscle groups. Otherwise the skin will be projected to the farthest muscle."], "extent": [5046, 5235]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Attenuate with Weights"], "extent": [5235, 5259], "body": [{"type": "para", "indent": 4, "text": ["Scale the displacement of points for each muscle group by the corresponding capture weights (if any).  "], "extent": [5259, 5368]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Cutoff Weight"], "extent": [5368, 5383], "body": [{"type": "para", "indent": 4, "text": ["Only consider points with weights greater than this cutoff when computing the point displacement."], "extent": [5383, 5486]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Cache Time Independent Topology"], "extent": [5486, 5519], "body": [{"type": "para", "indent": 4, "text": ["Turn this on if the geometry in the input remains topologically the same throughout the animation, for a minor performance boost."], "extent": [5519, 5654]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Cache Frame"], "extent": [5654, 5667], "body": [{"type": "para", "indent": 8, "text": ["When ", {"type": "ui", "text": ["Cache Time Independent Topolgy"]}, " is enabled, this parameter specifies the time (frame) to generate the cache.  Use this parameter if you have a geometry sequence to deform that has a start frame other than frame 1."], "extent": [5667, 5906]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Project from Muscle Centers"], "extent": [5906, 5935], "body": [{"type": "para", "indent": 4, "text": ["When enabled, skin points will be projected away from the Muscle Center points given on the second (or third if provided) input. This option also enables all ", {"type": "ui", "text": ["Center Projection Control"]}, " options."], "extent": [5935, 6138]}], "container": true, "role": "item"}], "container": true, "role": "item_group"}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Smoothing"], "extent": [6138, 6154], "body": [{"type": "para", "indent": 0, "text": ["This set of controls allows the user to smooth out any harsh projection artifacts making the result look more organic.\nSince this node does not compute output normals, ensure that normals are computed when visualizing the output (with the ", {"scheme": "Node", "value": "/nodes/sop/normal", "type": "link", "text": ["Normal SOP"], "fullpath": "/nodes/sop/normal"}, " for instance) before making a judgment on how the surface looks."], "extent": [6154, 6493]}, {"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Smoothing Method"], "extent": [6493, 6511], "body": [{"type": "para", "indent": 4, "text": ["Set the method for weighing neighbor contributions on position and normal smoothing options."], "extent": [6511, 6613]}, {"type": "dt_group", "body": [{"type": "dt", "indent": 4, "text": ["Uniform"], "extent": [6613, 6626], "body": [{"type": "para", "indent": 8, "text": ["Smooth evenly regardless of their distance from one another."], "extent": [6626, 6696]}], "container": true}, {"type": "dt", "indent": 4, "text": ["Edge Length"], "extent": [6696, 6713], "body": [{"type": "para", "indent": 8, "text": ["Smooth accounting for the fact that some points may be closer than others.\n        This option preserves relative distances between points, which is especially useful when points on the input are unevenly distributed."], "extent": [6713, 6941]}], "container": true}], "container": true}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Global Iterations"], "extent": [6941, 6960], "body": [{"type": "para", "indent": 4, "text": ["The number of times the input geometry is smoothed. This works as in ", {"type": "ui", "text": ["Delta Mush"]}, " where only the displacement is smoothed, preserving initial detail in the skin mesh."], "extent": [6960, 7134]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Falloff Iterations"], "extent": [7134, 7154], "body": [{"type": "para", "indent": 4, "text": ["Smooth the area of skin where the skin drapes away from the peak displacement. In contrast to ", {"type": "ui", "text": ["Global Iterations"]}, " this type of smoothing will not reduce the amount of displacement."], "extent": [7154, 7342]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Normal Iterations"], "extent": [7342, 7361], "body": [{"type": "para", "indent": 4, "text": ["Smooth the point normals used for projection. Note that this will have no effect if displacement is computed purely from muscle centers (when ", {"type": "ui", "text": ["Normal Projection Mixing"]}, " is set to 0)."], "extent": [7361, 7551]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Step Size"], "extent": [7551, 7562], "body": [{"type": "para", "indent": 4, "text": ["This controls the size of each smoothing step for all types of smoothing iterations."], "extent": [7562, 7652]}], "container": true, "role": "item"}], "container": true, "role": "item_group"}]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Thickness Control"], "extent": [7652, 7676], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Thickness"], "extent": [7676, 7688], "body": [{"type": "para", "indent": 4, "text": ["A constant point offset amount along the point normal."], "extent": [7688, 7748]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Thickness Falloff"], "extent": [7748, 7767], "body": [{"type": "para", "indent": 4, "text": ["Reduces the amount of offset amount in areas of maximum displacement."], "extent": [7767, 7842]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Maximum Bulge"], "extent": [7842, 7857], "body": [{"type": "para", "indent": 4, "text": ["The maximum distance to which the skin geometry will be projected."], "extent": [7857, 7930]}], "container": true, "role": "item"}], "container": true, "role": "item_group"}]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Center Projection Control"], "extent": [7930, 7962], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Tightness"], "extent": [7962, 7974], "body": [{"type": "para", "indent": 4, "text": ["Determines how closely the skin drapes around the muscle. Higher values make the skin drape tighter around the muscle."], "extent": [7974, 8098]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Normal Projection Mixing"], "extent": [8098, 8124], "body": [{"type": "para", "indent": 4, "text": ["Mix projection direction between the normal direction (at 1) and the direction from muscle centers (at 0)."], "extent": [8124, 8236]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Blend Radius"], "extent": [8236, 8250], "body": [{"type": "para", "indent": 4, "text": ["The radius away from the closest muscle center, which includes all muscle centers to be considered when picking a point to project from."], "extent": [8250, 8392]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Blend Exponent"], "extent": [8392, 8408], "body": [{"type": "para", "indent": 4, "text": ["This slider controls how much distant muscle centers contribute to the computation of the point to project from. Note that only muscle centers within the ", {"type": "ui", "text": ["Blend Radius"]}, " from the closest muscle center are considered. The higher the value, the more weight is given to points closest to the closest muscle center."], "extent": [8408, 8726]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Min Surf Distance"], "extent": [8726, 8745], "body": [{"type": "para", "indent": 4, "text": ["When enabled, projects all muscle centers that fall outside of the skin geometry (as determined by the normal of the closest primitive) to the interior of the skin. If a center is inside the skin but closer than the allowed distance, it will also be pushed further away from the skin."], "extent": [8745, 9037]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Overlap Exponent"], "extent": [9037, 9055], "body": [{"type": "para", "indent": 4, "text": ["This parameter controls how the displacements from different muscle groups are combined to produce the final displacement. When disabled, each consecutive muscle group will displace the skin geometry one after the other in some arbitrary order.  When enabled, the displacement magnitudes are raised to the given exponent, added and then raised to the reciprocal of the given exponent.  In effect, an exponent of 1 will simply add all the magnitudes, while a larger exponent will pick the largest of all magnitudes. This is only a heuristic to combine contributions from different muscle groups."], "extent": [9055, 9656]}], "container": true, "role": "item"}], "container": true, "role": "item_group"}]}], "text": "Parameters"}, {"level": 1, "id": "related", "container": true, "type": "related_section", "indent": 0, "role": "section", "extent": [9656, 9665], "body": [{"type": "bullet_group", "body": [{"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/sop/musclecapture", "type": "link", "text": "", "fullpath": "/nodes/sop/musclecapture"}], "extent": [9665, 9693]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/sop/deltamush", "type": "link", "text": "", "fullpath": "/nodes/sop/deltamush"}], "extent": [9693, 9717]}], "container": true}], "text": "Related"}], "title": ["Muscle Deform"], "summary": ["Deforms a surface mesh representing skin to envelop or drape over geometry representing muscles"]}